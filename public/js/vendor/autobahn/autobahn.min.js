window.define||(window.define=function(e){try{delete window.define}catch(n){window.define=void 0}window.when=e()},window.define.amd={}),function(e){e||(e=window.console={log:function(e,n,o,t,r){},info:function(e,n,o,t,r){},warn:function(e,n,o,t,r){},error:function(e,n,o,t,r){}}),Function.prototype.bind||(Function.prototype.bind=function(e){var n=this,o=Array.prototype.slice.call(arguments,1);return function(){return n.apply(e,Array.prototype.concat.apply(o,arguments))}}),"object"==typeof e.log&&(e.log=Function.prototype.call.bind(e.log,e),e.info=Function.prototype.call.bind(e.info,e),e.warn=Function.prototype.call.bind(e.warn,e),e.error=Function.prototype.call.bind(e.error,e)),"group"in e||(e.group=function(n){e.info("\n--- "+n+" ---\n")}),"groupEnd"in e||(e.groupEnd=function(){e.log("\n")}),"time"in e||function(){var n={};e.time=function(e){n[e]=(new Date).getTime()},e.timeEnd=function(o){var t=(new Date).getTime(),r=o in n?t-n[o]:0;e.info(o+": "+r+"ms")}}()}(window.console),function(e){"use strict";e(function(e){function n(e,n,o,t){return r(e).then(n,o,t)}function o(e){return new t(e,j.PromiseStatus&&j.PromiseStatus())}function t(e,n){function o(){return l?l.inspect():O()}function t(e,n,o,t,r){function i(i){i._when(e,n,o,t,r)}f?f.push(i):A(function(){i(l)})}function r(e){if(f){var o=f;f=Y,A(function(){l=a(c,e),n&&d(l,n),u(o,l)})}}function i(e){r(new p(e))}function s(e){if(f){var n=f;A(function(){u(n,new _(e))})}}var c,l,f=[];c=this,this._status=n,this.inspect=o,this._when=t;try{e(r,i,s)}catch(h){i(h)}}function r(e){return e instanceof t?e:i(e)}function i(e){return o(function(n){n(e)})}function s(e){return n(e,function(e){return new p(e)})}function c(){function e(e,o,s){n.resolve=n.resolver.resolve=function(n){return r?i(n):(r=!0,e(n),t)},n.reject=n.resolver.reject=function(e){return r?i(new p(e)):(r=!0,o(e),t)},n.notify=n.resolver.notify=function(e){return s(e),e}}var n,t,r;return n={promise:Y,resolve:Y,reject:Y,notify:Y,resolver:{resolve:Y,reject:Y,notify:Y}},n.promise=t=o(e),n}function u(e,n){for(var o=0;o<e.length;o++)e[o](n)}function a(e,n){if(n===e)return new p(new TypeError);if(n instanceof t)return n;try{var o=n===Object(n)&&n.then;return"function"==typeof o?l(o,n):new f(n)}catch(r){return new p(r)}}function l(e,n){return o(function(o,t){D(e,n,o,t)})}function f(e){this.value=e}function p(e){this.value=e}function _(e){this.value=e}function d(e,n){function o(){n.fulfilled()}function t(e){n.rejected(e)}e.then(o,t)}function h(e){return e&&"function"==typeof e.then}function g(e,t,r,i,s){return n(e,function(e){function c(o,r,i){function s(e){_(e)}function c(e){p(e)}var u,a,l,f,p,_,d,h;if(d=e.length>>>0,u=Math.max(0,Math.min(t,d)),l=[],a=d-u+1,f=[],u)for(_=function(e){f.push(e),--a||(p=_=k,r(f))},p=function(e){l.push(e),--u||(p=_=k,o(l))},h=0;d>h;++h)h in e&&n(e[h],c,s,i);else o(l)}return o(c).then(r,i,s)})}function b(e,n,o,t){function r(e){return n?n(e[0]):e[0]}return g(e,1,r,o,t)}function E(e,n,o,t){return S(e,k).then(n,o,t)}function w(){return S(arguments,k)}function v(e){return S(e,m,x)}function y(e,n){return S(e,n)}function S(e,o,r){return n(e,function(e){function i(t,i,s){function c(e,c){n(e,o,r).then(function(e){u[c]=e,--l||t(u)},i,s)}var u,a,l,f;if(l=a=e.length>>>0,u=[],!l)return void t(u);for(f=0;a>f;f++)f in e?c(e[f],f):--l}return new t(i)})}function C(e,o){var t=D(R,arguments,1);return n(e,function(e){var r;return r=e.length,t[0]=function(e,t,i){return n(e,function(e){return n(t,function(n){return o(e,n,i,r)})})},P.apply(e,t)})}function m(e){return{state:"fulfilled",value:e}}function x(e){return{state:"rejected",reason:e}}function O(){return{state:"pending"}}function A(e){1===U.push(e)&&B(N)}function N(){u(U),U=[]}function k(e){return e}function I(e){throw"function"==typeof j.reportUnhandled?j.reportUnhandled():A(function(){throw e}),e}n.promise=o,n.resolve=i,n.reject=s,n.defer=c,n.join=w,n.all=E,n.map=y,n.reduce=C,n.settle=v,n.any=b,n.some=g,n.isPromise=h,n.isPromiseLike=h,M=t.prototype,M.then=function(e,n,o){var r=this;return new t(function(t,i,s){r._when(t,s,e,n,o)},this._status&&this._status.observed())},M["catch"]=M.otherwise=function(e){return this.then(Y,e)},M["finally"]=M.ensure=function(e){function n(){return i(e())}return"function"==typeof e?this.then(n,n)["yield"](this):this},M.done=function(e,n){this.then(e,n)["catch"](I)},M["yield"]=function(e){return this.then(function(){return e})},M.tap=function(e){return this.then(e)["yield"](this)},M.spread=function(e){return this.then(function(n){return E(n,function(n){return e.apply(Y,n)})})},M.always=function(e,n){return this.then(e,e,n)},T=Object.create||function(e){function n(){}return n.prototype=e,new n},f.prototype=T(M),f.prototype.inspect=function(){return m(this.value)},f.prototype._when=function(e,n,o){try{e("function"==typeof o?o(this.value):this.value)}catch(t){e(new p(t))}},p.prototype=T(M),p.prototype.inspect=function(){return x(this.value)},p.prototype._when=function(e,n,o,t){try{e("function"==typeof t?t(this.value):this)}catch(r){e(new p(r))}},_.prototype=T(M),_.prototype._when=function(e,n,o,t,r){try{n("function"==typeof r?r(this.value):this.value)}catch(i){n(i)}};var M,T,P,R,D,B,U,H,W,L,j,F,z,G,Y;if(z=e,U=[],j="undefined"!=typeof console?console:n,"object"==typeof process&&process.nextTick)B=process.nextTick;else if(G="function"==typeof MutationObserver&&MutationObserver||"function"==typeof WebKitMutationObserver&&WebKitMutationObserver)B=function(e,n,o){var t=e.createElement("div");return new n(o).observe(t,{attributes:!0}),function(){t.setAttribute("x","x")}}(document,G,N);else try{B=z("vertx").runOnLoop||z("vertx").runOnContext}catch(J){F=setTimeout,B=function(e){F(e,0)}}return H=Function.prototype,W=H.call,D=H.bind?W.bind(W):function(e,n){return e.apply(n,R.call(arguments,2))},L=[],R=L.slice,P=L.reduce||function(e){var n,o,t,r,i;if(i=0,n=Object(this),r=n.length>>>0,o=arguments,o.length<=1)for(;;){if(i in n){t=n[i++];break}if(++i>=r)throw new TypeError}else t=o[1];for(;r>i;++i)i in n&&(t=e(t,n[i],i,n));return t},n})}("function"==typeof define&&define.amd?define:function(e){module.exports=e(require)});var CryptoJS=CryptoJS||function(e,n){var o={},t=o.lib={},r=t.Base=function(){function e(){}return{extend:function(n){e.prototype=this;var o=new e;return n&&o.mixIn(n),o.hasOwnProperty("init")||(o.init=function(){o.$super.init.apply(this,arguments)}),o.init.prototype=o,o.$super=this,o},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var n in e)e.hasOwnProperty(n)&&(this[n]=e[n]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),i=t.WordArray=r.extend({init:function(e,o){e=this.words=e||[],o!=n?this.sigBytes=o:this.sigBytes=4*e.length},toString:function(e){return(e||c).stringify(this)},concat:function(e){var n=this.words,o=e.words,t=this.sigBytes,r=e.sigBytes;if(this.clamp(),t%4)for(var i=0;r>i;i++){var s=o[i>>>2]>>>24-i%4*8&255;n[t+i>>>2]|=s<<24-(t+i)%4*8}else if(o.length>65535)for(var i=0;r>i;i+=4)n[t+i>>>2]=o[i>>>2];else n.push.apply(n,o);return this.sigBytes+=r,this},clamp:function(){var n=this.words,o=this.sigBytes;n[o>>>2]&=4294967295<<32-o%4*8,n.length=e.ceil(o/4)},clone:function(){var e=r.clone.call(this);return e.words=this.words.slice(0),e},random:function(n){for(var o=[],t=0;n>t;t+=4)o.push(4294967296*e.random()|0);return new i.init(o,n)}}),s=o.enc={},c=s.Hex={stringify:function(e){for(var n=e.words,o=e.sigBytes,t=[],r=0;o>r;r++){var i=n[r>>>2]>>>24-r%4*8&255;t.push((i>>>4).toString(16)),t.push((15&i).toString(16))}return t.join("")},parse:function(e){for(var n=e.length,o=[],t=0;n>t;t+=2)o[t>>>3]|=parseInt(e.substr(t,2),16)<<24-t%8*4;return new i.init(o,n/2)}},u=s.Latin1={stringify:function(e){for(var n=e.words,o=e.sigBytes,t=[],r=0;o>r;r++){var i=n[r>>>2]>>>24-r%4*8&255;t.push(String.fromCharCode(i))}return t.join("")},parse:function(e){for(var n=e.length,o=[],t=0;n>t;t++)o[t>>>2]|=(255&e.charCodeAt(t))<<24-t%4*8;return new i.init(o,n)}},a=s.Utf8={stringify:function(e){try{return decodeURIComponent(escape(u.stringify(e)))}catch(n){throw new Error("Malformed UTF-8 data")}},parse:function(e){return u.parse(unescape(encodeURIComponent(e)))}},l=t.BufferedBlockAlgorithm=r.extend({reset:function(){this._data=new i.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=a.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(n){var o=this._data,t=o.words,r=o.sigBytes,s=this.blockSize,c=4*s,u=r/c;u=n?e.ceil(u):e.max((0|u)-this._minBufferSize,0);var a=u*s,l=e.min(4*a,r);if(a){for(var f=0;a>f;f+=s)this._doProcessBlock(t,f);var p=t.splice(0,a);o.sigBytes-=l}return new i.init(p,l)},clone:function(){var e=r.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0}),f=(t.Hasher=l.extend({cfg:r.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){l.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){e&&this._append(e);var n=this._doFinalize();return n},blockSize:16,_createHelper:function(e){return function(n,o){return new e.init(o).finalize(n)}},_createHmacHelper:function(e){return function(n,o){return new f.HMAC.init(e,o).finalize(n)}}}),o.algo={});return o}(Math);!function(){var e=CryptoJS,n=e.lib,o=n.WordArray,t=e.enc;t.Base64={stringify:function(e){var n=e.words,o=e.sigBytes,t=this._map;e.clamp();for(var r=[],i=0;o>i;i+=3)for(var s=n[i>>>2]>>>24-i%4*8&255,c=n[i+1>>>2]>>>24-(i+1)%4*8&255,u=n[i+2>>>2]>>>24-(i+2)%4*8&255,a=s<<16|c<<8|u,l=0;4>l&&o>i+.75*l;l++)r.push(t.charAt(a>>>6*(3-l)&63));var f=t.charAt(64);if(f)for(;r.length%4;)r.push(f);return r.join("")},parse:function(e){var n=e.length,t=this._map,r=t.charAt(64);if(r){var i=e.indexOf(r);-1!=i&&(n=i)}for(var s=[],c=0,u=0;n>u;u++)if(u%4){var a=t.indexOf(e.charAt(u-1))<<u%4*2,l=t.indexOf(e.charAt(u))>>>6-u%4*2;s[c>>>2]|=(a|l)<<24-c%4*8,c++}return o.create(s,c)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),function(){var e=CryptoJS,n=e.lib,o=n.Base,t=e.enc,r=t.Utf8,i=e.algo;i.HMAC=o.extend({init:function(e,n){e=this._hasher=new e.init,"string"==typeof n&&(n=r.parse(n));var o=e.blockSize,t=4*o;n.sigBytes>t&&(n=e.finalize(n)),n.clamp();for(var i=this._oKey=n.clone(),s=this._iKey=n.clone(),c=i.words,u=s.words,a=0;o>a;a++)c[a]^=1549556828,u[a]^=909522486;i.sigBytes=s.sigBytes=t,this.reset()},reset:function(){var e=this._hasher;e.reset(),e.update(this._iKey)},update:function(e){return this._hasher.update(e),this},finalize:function(e){var n=this._hasher,o=n.finalize(e);n.reset();var t=n.finalize(this._oKey.clone().concat(o));return t}})}(),function(e){var n=CryptoJS,o=n.lib,t=o.WordArray,r=o.Hasher,i=n.algo,s=[],c=[];!function(){function n(n){for(var o=e.sqrt(n),t=2;o>=t;t++)if(!(n%t))return!1;return!0}function o(e){return 4294967296*(e-(0|e))|0}for(var t=2,r=0;64>r;)n(t)&&(8>r&&(s[r]=o(e.pow(t,.5))),c[r]=o(e.pow(t,1/3)),r++),t++}();var u=[],a=i.SHA256=r.extend({_doReset:function(){this._hash=new t.init(s.slice(0))},_doProcessBlock:function(e,n){for(var o=this._hash.words,t=o[0],r=o[1],i=o[2],s=o[3],a=o[4],l=o[5],f=o[6],p=o[7],_=0;64>_;_++){if(16>_)u[_]=0|e[n+_];else{var d=u[_-15],h=(d<<25|d>>>7)^(d<<14|d>>>18)^d>>>3,g=u[_-2],b=(g<<15|g>>>17)^(g<<13|g>>>19)^g>>>10;u[_]=h+u[_-7]+b+u[_-16]}var E=a&l^~a&f,w=t&r^t&i^r&i,v=(t<<30|t>>>2)^(t<<19|t>>>13)^(t<<10|t>>>22),y=(a<<26|a>>>6)^(a<<21|a>>>11)^(a<<7|a>>>25),S=p+y+E+c[_]+u[_],C=v+w;p=f,f=l,l=a,a=s+S|0,s=i,i=r,r=t,t=S+C|0}o[0]=o[0]+t|0,o[1]=o[1]+r|0,o[2]=o[2]+i|0,o[3]=o[3]+s|0,o[4]=o[4]+a|0,o[5]=o[5]+l|0,o[6]=o[6]+f|0,o[7]=o[7]+p|0},_doFinalize:function(){var n=this._data,o=n.words,t=8*this._nDataBytes,r=8*n.sigBytes;return o[r>>>5]|=128<<24-r%32,o[(r+64>>>9<<4)+14]=e.floor(t/4294967296),o[(r+64>>>9<<4)+15]=t,n.sigBytes=4*o.length,this._process(),this._hash},clone:function(){var e=r.clone.call(this);return e._hash=this._hash.clone(),e}});n.SHA256=r._createHelper(a),n.HmacSHA256=r._createHmacHelper(a)}(Math),function(){var e=CryptoJS,n=e.lib,o=n.Base,t=n.WordArray,r=e.algo,i=r.SHA1,s=r.HMAC,c=r.PBKDF2=o.extend({cfg:o.extend({keySize:4,hasher:i,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,n){for(var o=this.cfg,r=s.create(o.hasher,e),i=t.create(),c=t.create([1]),u=i.words,a=c.words,l=o.keySize,f=o.iterations;u.length<l;){var p=r.update(n).finalize(c);r.reset();for(var _=p.words,d=_.length,h=p,g=1;f>g;g++){h=r.finalize(h),r.reset();for(var b=h.words,E=0;d>E;E++)_[E]^=b[E]}i.concat(p),a[0]++}return i.sigBytes=4*l,i}});e.PBKDF2=function(e,n,o){return c.create(o).compute(e,n)}}();var AUTOBAHNJS_VERSION="?.?.?",global=this;!function(e,n){"function"==typeof define&&define.amd?define(["when"],function(o){return e.ab=n(e,o)}):"undefined"!=typeof exports?"undefined"!=typeof module&&module.exports&&(exports=module.exports=n(e,e.when)):e.ab=n(e,e.when)}(global,function(e,n){"use strict";var o={};return o._version=AUTOBAHNJS_VERSION,function(){Array.prototype.indexOf||(Array.prototype.indexOf=function(e){if(null===this)throw new TypeError;var n=new Object(this),o=n.length>>>0;if(0===o)return-1;var t=0;if(arguments.length>0&&(t=Number(arguments[1]),t!==t?t=0:0!==t&&t!==1/0&&t!==-(1/0)&&(t=(t>0||-1)*Math.floor(Math.abs(t)))),t>=o)return-1;for(var r=t>=0?t:Math.max(o-Math.abs(t),0);o>r;r++)if(r in n&&n[r]===e)return r;return-1}),Array.prototype.forEach||(Array.prototype.forEach=function(e,n){var o,t;if(null===this)throw new TypeError(" this is null or not defined");var r=new Object(this),i=r.length>>>0;if("[object Function]"!=={}.toString.call(e))throw new TypeError(e+" is not a function");for(n&&(o=n),t=0;i>t;){var s;t in r&&(s=r[t],e.call(o,s,t,r)),t++}})}(),o._sliceUserAgent=function(e,n,o){var t=[],r=navigator.userAgent,i=r.indexOf(e),s=r.indexOf(n,i);0>s&&(s=r.length);for(var c=r.slice(i,s).split(o),u=c[1].split("."),a=0;a<u.length;++a)t.push(parseInt(u[a],10));return{name:c[0],version:t}},o.getBrowser=function(){var e=navigator.userAgent;return e.indexOf("Chrome")>-1?o._sliceUserAgent("Chrome"," ","/"):e.indexOf("Safari")>-1?o._sliceUserAgent("Safari"," ","/"):e.indexOf("Firefox")>-1?o._sliceUserAgent("Firefox"," ","/"):e.indexOf("MSIE")>-1?o._sliceUserAgent("MSIE",";"," "):null},o.getServerUrl=function(n,o){if("file:"===e.location.protocol)return o?o:"ws://127.0.0.1/ws";var t="https:"===e.location.protocol?"wss://":"ws://",r=""!==e.location.port?":"+e.location.port:"",i=n?n:"ws";return t+e.location.hostname+r+"/"+i},o.browserNotSupportedMessage="Browser does not support WebSockets (RFC6455)",o.deriveKey=function(e,n){if(n&&n.salt){var o=n.salt,t=n.keylen||32,r=n.iterations||1e4,i=CryptoJS.PBKDF2(e,o,{keySize:t/4,iterations:r,hasher:CryptoJS.algo.SHA256});return i.toString(CryptoJS.enc.Base64)}return e},o._idchars="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",o._idlen=16,o._subprotocol="wamp",o._newid=function(){for(var e="",n=0;n<o._idlen;n+=1)e+=o._idchars.charAt(Math.floor(Math.random()*o._idchars.length));return e},o._newidFast=function(){return Math.random().toString(36)},o.log=function(){if(arguments.length>1){console.group("Log Item");for(var e=0;e<arguments.length;e+=1)console.log(arguments[e]);console.groupEnd()}else console.log(arguments[0])},o._debugrpc=!1,o._debugpubsub=!1,o._debugws=!1,o._debugconnect=!1,o.debug=function(n,t,r){if(!("console"in e))throw"browser does not support console object";o._debugrpc=n,o._debugpubsub=n,o._debugws=t,o._debugconnect=r},o.version=function(){return o._version},o.PrefixMap=function(){var e=this;e._index={},e._rindex={}},o.PrefixMap.prototype.get=function(e){var n=this;return n._index[e]},o.PrefixMap.prototype.set=function(e,n){var o=this;o._index[e]=n,o._rindex[n]=e},o.PrefixMap.prototype.setDefault=function(e){var n=this;n._index[""]=e,n._rindex[e]=""},o.PrefixMap.prototype.remove=function(e){var n=this,o=n._index[e];o&&(delete n._index[e],delete n._rindex[o])},o.PrefixMap.prototype.resolve=function(e,n){var o=this,t=e.indexOf(":");if(t>=0){var r=e.substring(0,t);if(o._index[r])return o._index[r]+e.substring(t+1)}return n===!0?e:null},o.PrefixMap.prototype.shrink=function(e,n){for(var o=this,t=e.length;t>0;t-=1){var r=e.substring(0,t),i=o._rindex[r];if(i)return i+":"+e.substring(t)}return n===!0?e:null},o._MESSAGE_TYPEID_WELCOME=0,o._MESSAGE_TYPEID_PREFIX=1,o._MESSAGE_TYPEID_CALL=2,o._MESSAGE_TYPEID_CALL_RESULT=3,o._MESSAGE_TYPEID_CALL_ERROR=4,o._MESSAGE_TYPEID_SUBSCRIBE=5,o._MESSAGE_TYPEID_UNSUBSCRIBE=6,o._MESSAGE_TYPEID_PUBLISH=7,o._MESSAGE_TYPEID_EVENT=8,o.CONNECTION_CLOSED=0,o.CONNECTION_LOST=1,o.CONNECTION_RETRIES_EXCEEDED=2,o.CONNECTION_UNREACHABLE=3,o.CONNECTION_UNSUPPORTED=4,o.CONNECTION_UNREACHABLE_SCHEDULED_RECONNECT=5,o.CONNECTION_LOST_SCHEDULED_RECONNECT=6,o.Deferred=n.defer,o._construct=function(n,o){return"WebSocket"in e?o?new WebSocket(n,o):new WebSocket(n):"MozWebSocket"in e?o?new MozWebSocket(n,o):new MozWebSocket(n):null},o.Session=function(e,n,t,r){var i=this;if(i._wsuri=e,i._options=r,i._websocket_onopen=n,i._websocket_onclose=t,i._websocket=null,i._websocket_connected=!1,i._session_id=null,i._wamp_version=null,i._server=null,i._calls={},i._subscriptions={},i._prefixes=new o.PrefixMap,i._txcnt=0,i._rxcnt=0,i._options&&i._options.skipSubprotocolAnnounce?i._websocket=o._construct(i._wsuri):i._websocket=o._construct(i._wsuri,[o._subprotocol]),!i._websocket){if(void 0!==t)return void t(o.CONNECTION_UNSUPPORTED);throw o.browserNotSupportedMessage}i._websocket.onmessage=function(e){o._debugws&&(i._rxcnt+=1,console.group("WS Receive"),console.info(i._wsuri+"  ["+i._session_id+"]"),console.log(i._rxcnt),console.log(e.data),console.groupEnd());var n=JSON.parse(e.data);if(n[1]in i._calls){if(n[0]===o._MESSAGE_TYPEID_CALL_RESULT){var t=i._calls[n[1]],r=n[2];if(o._debugrpc&&void 0!==t._ab_callobj){console.group("WAMP Call",t._ab_callobj[2]),console.timeEnd(t._ab_tid),console.group("Arguments");for(var s=3;s<t._ab_callobj.length;s+=1){var c=t._ab_callobj[s];if(void 0===c)break;console.log(c)}console.groupEnd(),console.group("Result"),console.log(r),console.groupEnd(),console.groupEnd()}t.resolve(r)}else if(n[0]===o._MESSAGE_TYPEID_CALL_ERROR){var u=i._calls[n[1]],a=n[2],l=n[3],f=n[4];if(o._debugrpc&&void 0!==u._ab_callobj){console.group("WAMP Call",u._ab_callobj[2]),console.timeEnd(u._ab_tid),console.group("Arguments");for(var p=3;p<u._ab_callobj.length;p+=1){var _=u._ab_callobj[p];if(void 0===_)break;console.log(_)}console.groupEnd(),console.group("Error"),console.log(a),console.log(l),void 0!==f&&console.log(f),console.groupEnd(),console.groupEnd()}void 0!==f?u.reject({uri:a,desc:l,detail:f}):u.reject({uri:a,desc:l})}delete i._calls[n[1]]}else if(n[0]===o._MESSAGE_TYPEID_EVENT){var d=i._prefixes.resolve(n[1],!0);if(d in i._subscriptions){var h=n[1],g=n[2];o._debugpubsub&&(console.group("WAMP Event"),console.info(i._wsuri+"  ["+i._session_id+"]"),console.log(h),console.log(g),console.groupEnd()),i._subscriptions[d].forEach(function(e){e(h,g)})}}else if(n[0]===o._MESSAGE_TYPEID_WELCOME){if(null!==i._session_id)throw"protocol error (welcome message received more than once)";i._session_id=n[1],i._wamp_version=n[2],i._server=n[3],(o._debugrpc||o._debugpubsub)&&(console.group("WAMP Welcome"),console.info(i._wsuri+"  ["+i._session_id+"]"),console.log(i._wamp_version),console.log(i._server),console.groupEnd()),null!==i._websocket_onopen&&i._websocket_onopen()}},i._websocket.onopen=function(e){if(i._websocket.protocol!==o._subprotocol)if("undefined"==typeof i._websocket.protocol)o._debugws&&(console.group("WS Warning"),console.info(i._wsuri),console.log("WebSocket object has no protocol attribute: WAMP subprotocol check skipped!"),console.groupEnd());else{if(!i._options||!i._options.skipSubprotocolCheck)throw i._websocket.close(1e3,"server does not speak WAMP"),"server does not speak WAMP (but '"+i._websocket.protocol+"' !)";o._debugws&&(console.group("WS Warning"),console.info(i._wsuri),console.log("Server does not speak WAMP, but subprotocol check disabled by option!"),console.log(i._websocket.protocol),console.groupEnd())}o._debugws&&(console.group("WAMP Connect"),console.info(i._wsuri),console.log(i._websocket.protocol),console.groupEnd()),i._websocket_connected=!0},i._websocket.onerror=function(e){},i._websocket.onclose=function(e){o._debugws&&(i._websocket_connected?console.log("Autobahn connection to "+i._wsuri+" lost (code "+e.code+", reason '"+e.reason+"', wasClean "+e.wasClean+")."):console.log("Autobahn could not connect to "+i._wsuri+" (code "+e.code+", reason '"+e.reason+"', wasClean "+e.wasClean+").")),void 0!==i._websocket_onclose&&(i._websocket_connected?e.wasClean?i._websocket_onclose(o.CONNECTION_CLOSED,"WS-"+e.code+": "+e.reason):i._websocket_onclose(o.CONNECTION_LOST):i._websocket_onclose(o.CONNECTION_UNREACHABLE)),i._websocket_connected=!1,i._wsuri=null,i._websocket_onopen=null,i._websocket_onclose=null,i._websocket=null},i.log=function(){i._options&&"sessionIdent"in i._options?console.group("WAMP Session '"+i._options.sessionIdent+"' ["+i._session_id+"]"):console.group("WAMP Session ["+i._session_id+"]");for(var e=0;e<arguments.length;++e)console.log(arguments[e]);console.groupEnd()}},o.Session.prototype._send=function(n){var t=this;if(!t._websocket_connected)throw"Autobahn not connected";var r;switch(!0){case e.Prototype&&"undefined"==typeof top.root.__prototype_deleted:case"function"==typeof n.toJSON:r=n.toJSON();break;default:r=JSON.stringify(n)}t._websocket.send(r),t._txcnt+=1,o._debugws&&(console.group("WS Send"),console.info(t._wsuri+"  ["+t._session_id+"]"),console.log(t._txcnt),console.log(r),console.groupEnd())},o.Session.prototype.close=function(){var e=this;e._websocket_connected&&e._websocket.close()},o.Session.prototype.sessionid=function(){var e=this;return e._session_id},o.Session.prototype.wsuri=function(){var e=this;return e._wsuri},o.Session.prototype.shrink=function(e,n){var o=this;return void 0===n&&(n=!0),o._prefixes.shrink(e,n)},o.Session.prototype.resolve=function(e,n){var o=this;return void 0===n&&(n=!0),o._prefixes.resolve(e,n)},o.Session.prototype.prefix=function(e,n){var t=this;t._prefixes.set(e,n),(o._debugrpc||o._debugpubsub)&&(console.group("WAMP Prefix"),console.info(t._wsuri+"  ["+t._session_id+"]"),console.log(e),console.log(n),console.groupEnd());var r=[o._MESSAGE_TYPEID_PREFIX,e,n];t._send(r)},o.Session.prototype.call=function(){for(var e,n=this,t=new o.Deferred;;)if(e=o._newidFast(),!(e in n._calls))break;n._calls[e]=t;for(var r=n._prefixes.shrink(arguments[0],!0),i=[o._MESSAGE_TYPEID_CALL,e,r],s=1;s<arguments.length;s+=1)i.push(arguments[s]);return n._send(i),o._debugrpc&&(t._ab_callobj=i,t._ab_tid=n._wsuri+"  ["+n._session_id+"]["+e+"]",console.time(t._ab_tid),console.info()),t.promise.then?t.promise:t},o.Session.prototype.subscribe=function(e,n){var t=this,r=t._prefixes.resolve(e,!0);if(!(r in t._subscriptions)){o._debugpubsub&&(console.group("WAMP Subscribe"),console.info(t._wsuri+"  ["+t._session_id+"]"),console.log(e),console.log(n),console.groupEnd());var i=[o._MESSAGE_TYPEID_SUBSCRIBE,e];t._send(i),t._subscriptions[r]=[]}var s=t._subscriptions[r].indexOf(n);if(-1!==s)throw"callback "+n+" already subscribed for topic "+r;t._subscriptions[r].push(n)},o.Session.prototype.unsubscribe=function(e,n){var t=this,r=t._prefixes.resolve(e,!0);if(!(r in t._subscriptions))throw"not subscribed to topic "+r;var i;if(void 0!==n){var s=t._subscriptions[r].indexOf(n);if(-1===s)throw"no callback "+n+" subscribed on topic "+r;i=n,t._subscriptions[r].splice(s,1)}else i=t._subscriptions[r].slice(),t._subscriptions[r]=[];if(0===t._subscriptions[r].length){delete t._subscriptions[r],o._debugpubsub&&(console.group("WAMP Unsubscribe"),console.info(t._wsuri+"  ["+t._session_id+"]"),console.log(e),console.log(i),console.groupEnd());var c=[o._MESSAGE_TYPEID_UNSUBSCRIBE,e];t._send(c)}},o.Session.prototype.publish=function(){var e=this,n=arguments[0],t=arguments[1],r=null,i=null,s=null,c=null;if(arguments.length>3){if(!(arguments[2]instanceof Array))throw"invalid argument type(s)";if(!(arguments[3]instanceof Array))throw"invalid argument type(s)";i=arguments[2],s=arguments[3],c=[o._MESSAGE_TYPEID_PUBLISH,n,t,i,s]}else if(arguments.length>2)if("boolean"==typeof arguments[2])r=arguments[2],c=[o._MESSAGE_TYPEID_PUBLISH,n,t,r];else{if(!(arguments[2]instanceof Array))throw"invalid argument type(s)";i=arguments[2],c=[o._MESSAGE_TYPEID_PUBLISH,n,t,i]}else c=[o._MESSAGE_TYPEID_PUBLISH,n,t];o._debugpubsub&&(console.group("WAMP Publish"),console.info(e._wsuri+"  ["+e._session_id+"]"),console.log(n),console.log(t),null!==r?console.log(r):null!==i&&(console.log(i),null!==s&&console.log(s)),console.groupEnd()),e._send(c)},o.Session.prototype.authreq=function(e,n){return this.call("http://api.wamp.ws/procedure#authreq",e,n)},o.Session.prototype.authsign=function(e,n){return n||(n=""),CryptoJS.HmacSHA256(e,n).toString(CryptoJS.enc.Base64)},o.Session.prototype.auth=function(e){return this.call("http://api.wamp.ws/procedure#auth",e)},o._connect=function(n){var t=new o.Session(n.wsuri,function(){n.connects+=1,n.retryCount=0,n.onConnect(t)},function(t,r){var i=null;switch(t){case o.CONNECTION_CLOSED:n.onHangup(t,"Connection was closed properly ["+r+"]");break;case o.CONNECTION_UNSUPPORTED:n.onHangup(t,"Browser does not support WebSocket.");break;case o.CONNECTION_UNREACHABLE:n.retryCount+=1,0===n.connects?n.onHangup(t,"Connection could not be established."):n.retryCount<=n.options.maxRetries?(i=n.onHangup(o.CONNECTION_UNREACHABLE_SCHEDULED_RECONNECT,"Connection unreachable - scheduled reconnect to occur in "+n.options.retryDelay/1e3+" second(s) - attempt "+n.retryCount+" of "+n.options.maxRetries+".",{delay:n.options.retryDelay,retries:n.retryCount,maxretries:n.options.maxRetries}),i?(o._debugconnect&&console.log("Connection unreachable - retrying stopped by app"),n.onHangup(o.CONNECTION_RETRIES_EXCEEDED,"Number of connection retries exceeded.")):(o._debugconnect&&console.log("Connection unreachable - retrying ("+n.retryCount+") .."),e.setTimeout(function(){o._connect(n)},n.options.retryDelay))):n.onHangup(o.CONNECTION_RETRIES_EXCEEDED,"Number of connection retries exceeded.");break;case o.CONNECTION_LOST:n.retryCount+=1,n.retryCount<=n.options.maxRetries?(i=n.onHangup(o.CONNECTION_LOST_SCHEDULED_RECONNECT,"Connection lost - scheduled "+n.retryCount+"th reconnect to occur in "+n.options.retryDelay/1e3+" second(s).",{delay:n.options.retryDelay,retries:n.retryCount,maxretries:n.options.maxRetries}),i?(o._debugconnect&&console.log("Connection lost - retrying stopped by app"),n.onHangup(o.CONNECTION_RETRIES_EXCEEDED,"Connection lost.")):(o._debugconnect&&console.log("Connection lost - retrying ("+n.retryCount+") .."),e.setTimeout(function(){o._connect(n)},n.options.retryDelay))):n.onHangup(o.CONNECTION_RETRIES_EXCEEDED,"Connection lost.");break;default:throw"unhandled close code in ab._connect"}},n.options)},o.connect=function(e,n,t,r){var i={};if(i.wsuri=e,r?i.options=r:i.options={},void 0===i.options.retryDelay&&(i.options.retryDelay=5e3),void 0===i.options.maxRetries&&(i.options.maxRetries=10),void 0===i.options.skipSubprotocolCheck&&(i.options.skipSubprotocolCheck=!1),void 0===i.options.skipSubprotocolAnnounce&&(i.options.skipSubprotocolAnnounce=!1),!n)throw"onConnect handler required!";i.onConnect=n,t?i.onHangup=t:i.onHangup=function(e,n,t){o._debugconnect&&console.log(e,n,t)},i.connects=0,i.retryCount=0,o._connect(i)},o.launch=function(e,n,t){o.connect(e.wsuri,function(t){e.appkey&&""!==e.appkey?t.authreq(e.appkey,e.appextra).then(function(r){var i=null;if("function"==typeof e.appsecret)i=e.appsecret(r);else{var s=o.deriveKey(e.appsecret,JSON.parse(r).authextra);i=t.authsign(r,s)}t.auth(i).then(function(e){n?n(t):o._debugconnect&&t.log("Session opened.")},t.log)},t.log):t.authreq().then(function(){t.auth().then(function(e){n?n(t):o._debugconnect&&t.log("Session opened.")},t.log)},t.log)},function(e,n,r){t?t(e,n,r):o._debugconnect&&o.log("Session closed.",e,n,r)},e.sessionConfig)},o}),ab._UA_FIREFOX=new RegExp(".*Firefox/([0-9+]*).*"),ab._UA_CHROME=new RegExp(".*Chrome/([0-9+]*).*"),ab._UA_CHROMEFRAME=new RegExp(".*chromeframe/([0-9]*).*"),ab._UA_WEBKIT=new RegExp(".*AppleWebKit/([0-9+.]*)w*.*"),ab._UA_WEBOS=new RegExp(".*webOS/([0-9+.]*)w*.*"),ab._matchRegex=function(e,n){var o=n.exec(e);return o?o[1]:o},ab.lookupWsSupport=function(){var e=navigator.userAgent;if(e.indexOf("MSIE")>-1){if(e.indexOf("MSIE 10")>-1)return[!0,!0,!0];if(e.indexOf("chromeframe")>-1){var n=parseInt(ab._matchRegex(e,ab._UA_CHROMEFRAME));return n>=14?[!0,!1,!0]:[!1,!1,!1]}return e.indexOf("MSIE 8")>-1||e.indexOf("MSIE 9")>-1?[!0,!0,!0]:[!1,!1,!1]}if(e.indexOf("Firefox")>-1){var n=parseInt(ab._matchRegex(e,ab._UA_FIREFOX));return n?n>=7?[!0,!1,!0]:n>=3?[!0,!0,!0]:[!1,!1,!0]:[!1,!1,!0]}if(e.indexOf("Safari")>-1&&-1==e.indexOf("Chrome")){var n=ab._matchRegex(e,ab._UA_WEBKIT);return n?e.indexOf("Windows")>-1&&"534+"==n?[!0,!1,!0]:e.indexOf("Macintosh")>-1&&(n=n.replace("+","").split("."),535==parseInt(n[0])&&parseInt(n[1])>=24||parseInt(n[0])>535)?[!0,!1,!0]:e.indexOf("webOS")>-1?(n=ab._matchRegex(e,ab._UA_WEBOS).split("."),2==parseInt(n[0])?[!1,!0,!0]:[!1,!1,!1]):[!0,!0,!0]:[!1,!1,!1]}if(e.indexOf("Chrome")>-1){var n=parseInt(ab._matchRegex(e,ab._UA_CHROME));return n?n>=14?[!0,!1,!0]:n>=4?[!0,!0,!0]:[!1,!1,!0]:[!1,!1,!1]}return e.indexOf("Android")>-1?e.indexOf("Firefox")>-1?[!0,!1,!0]:e.indexOf("CrMo")>-1?[!0,!1,!0]:e.indexOf("Opera")>-1?[!1,!1,!0]:e.indexOf("CrMo")>-1?[!0,!0,!0]:[!1,!1,!1]:e.indexOf("iPhone")>-1||e.indexOf("iPad")>-1||e.indexOf("iPod")>-1?[!1,!1,!0]:[!1,!1,!1]};