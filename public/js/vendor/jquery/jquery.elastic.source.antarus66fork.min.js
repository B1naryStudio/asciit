!function(e){jQuery.fn.extend({elastic:function(e){var t=void 0!==e.compactOnBlur?e.compactOnBlur:!0,r=void 0!==e.emptyLinesBelow?+e.emptyLinesBelow:1,i=["paddingTop","paddingRight","paddingBottom","paddingLeft","fontSize","lineHeight","fontFamily","width","fontWeight","border-top-width","border-right-width","border-bottom-width","border-left-width","borderTopStyle","borderTopColor","borderRightStyle","borderRightColor","borderBottomStyle","borderBottomColor","borderLeftStyle","borderLeftColor"];return this.each(function(){function e(){var e=Math.floor(parseInt(h.width(),10));d.width()!==e&&(d.css({width:e+"px"}),n(!0))}function o(e,t){var r=Math.floor(parseInt(e,10));h.height()!==r&&h.css({height:r+"px",overflow:t})}function n(e){var t=h.val().replace(/&/g,"&amp;").replace(/ {2}/g,"&nbsp;").replace(/<|>/g,"&gt;").replace(/\n/g,"<br />"),i=d.html().replace(/<br>/gi,"<br />");if((e||t+"&nbsp;"!==i)&&(d.html(t+"&nbsp;"),Math.abs(d.height()+a-h.height())>3)){var n=d.height()+a*r;n>=p?o(p,"auto"):s>=n?o(s,"hidden"):o(n,"hidden")}}if("textarea"!==this.type)return!1;var h=jQuery(this),d=jQuery("<div />").css({position:"absolute",display:"none","word-wrap":"break-word","white-space":"pre-wrap"}),a=parseInt(h.css("line-height"),10)||parseInt(h.css("font-size"),"10"),s=parseInt(h.css("height"),10)||3*a,p=parseInt(h.css("max-height"),10)||Number.MAX_VALUE;0>p&&(p=Number.MAX_VALUE),d.appendTo(h.parent());for(var c=i.length;c--;)d.css(i[c].toString(),h.css(i[c].toString()));h.css({overflow:"hidden"}),h.bind("keyup change cut paste",function(){n()}),jQuery(window).bind("resize",e),h.bind("resize",e),h.bind("update",n),t&&h.bind("blur",function(){d.height()<p&&(d.height()>s?h.height(d.height()):h.height(s))}),h.bind("input paste",function(e){setTimeout(n,250)}),n()})}})}(jQuery);