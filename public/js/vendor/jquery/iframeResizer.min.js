/*! iFrame Resizer (iframeSizer.min.js ) - v3.2.0 - 2015-09-04
 *  Desc: Force cross domain iframes to size to content.
 *  Requires: iframeResizer.contentWindow.min.js to be loaded into the target frame.
 *  Copyright: (c) 2015 David J. Bradshaw - dave@bradshaw.net
 *  License: MIT
 */

!function(a){"use strict";function b(b,c,d){"addEventListener"in a?b.addEventListener(c,d,!1):"attachEvent"in a&&b.attachEvent("on"+c,d)}function c(){var b,c=["moz","webkit","o","ms"];for(b=0;b<c.length&&!K;b+=1)K=a[c[b]+"RequestAnimationFrame"];K||g("setup","RequestAnimationFrame not supported")}function d(b){var c="Host page: "+b;return a.top!==a.self&&(c=a.parentIFrame&&a.parentIFrame.getId?a.parentIFrame.getId()+": "+b:"Nested host page: "+b),c}function e(a){return H+"["+d(a)+"]"}function f(a){return M[a]?M[a].log:D}function g(a,b){j("log",a,b,f(a))}function h(a,b){j("info",a,b,f(a))}function i(a,b){j("warn",a,b,!0)}function j(b,c,d,f){!0===f&&"object"==typeof a.console&&console[b](e(c),d)}function k(b){function c(){function a(){r(N),o(P)}e("Height"),e("Width"),s(a,N,"resetPage")}function d(){var a=L.substr(I).split(":");return{iframe:M[a[0]].iframe,id:a[0],height:a[1],width:a[2],type:a[3]}}function e(a){var b=Number(M[P]["max"+a]),c=Number(M[P]["min"+a]),d=a.toLowerCase(),e=Number(N[d]);g(P,"Checking "+d+" is in range "+c+"-"+b),c>e&&(e=c,g(P,"Set "+d+" to min value")),e>b&&(e=b,g(P,"Set "+d+" to max value")),N[d]=""+e}function f(){function a(){function a(){var a=0,b=!1;for(g(P,"Checking connection is from allowed list of origins: "+d);a<d.length;a++)if(d[a]===c){b=!0;break}return b}function b(){var a=M[P].remoteHost;return g(P,"Checking connection is from: "+a),c===a}return d.constructor===Array?a():b()}var c=b.origin,d=M[P].checkOrigin;if(d&&""+c!="null"&&!a())throw new Error("Unexpected message received from: "+c+" for "+N.iframe.id+". Message was: "+b.data+". This error can be disabled by setting the checkOrigin: false option or by providing of array of trusted domains.");return!0}function j(){return H===(""+L).substr(0,I)&&L.substr(I).split(":")[0]in M}function k(){var a=N.type in{"true":1,"false":1,undefined:1};return a&&g(P,"Ignoring init message from meta parent page"),a}function v(a){return L.substr(L.indexOf(":")+G+a)}function w(a){g(P,"MessageCallback passed: {iframe: "+N.iframe.id+", message: "+a+"}"),C("messageCallback",{iframe:N.iframe,message:JSON.parse(a)}),g(P,"--")}function x(){var a=!0;return null===N.iframe&&(i(P,"IFrame ("+N.id+") not found"),a=!1),a}function y(a){var b=a.getBoundingClientRect();return n(P),{x:Math.floor(Number(b.left)+Number(J.x)),y:Math.floor(Number(b.top)+Number(J.y))}}function z(b){function c(){J=h,A(),g(P,"--")}function d(){return{x:Number(N.width)+f.x,y:Number(N.height)+f.y}}function e(){a.parentIFrame?a.parentIFrame["scrollTo"+(b?"Offset":"")](h.x,h.y):i(P,"Unable to scroll to requested position, window.parentIFrame not found")}var f=b?y(N.iframe):{x:0,y:0},h=d();g(P,"Reposition requested from iFrame (offset x:"+f.x+" y:"+f.y+")"),a.top!==a.self?e():c()}function A(){!1!==C("scrollCallback",J)?o(P):p()}function B(b){function c(){var a=y(h);g(P,"Moving to in page link (#"+e+") at x: "+a.x+" y: "+a.y),J={x:a.x,y:a.y},A(),g(P,"--")}function d(){a.parentIFrame?a.parentIFrame.moveToAnchor(e):console.log(P,"In page link #"+e+" not found and window.parentIFrame not found")}var e=b.split("#")[1]||"",f=decodeURIComponent(e),h=document.getElementById(f)||document.getElementsByName(f)[0];h?c():a.top!==a.self?d():consolelog(P,"In page link #"+e+" not found")}function C(a,b){return l(P,a,b)}function D(){switch(M[P].firstRun&&K(),N.type){case"close":m(N.iframe);break;case"message":w(v(6));break;case"scrollTo":z(!1);break;case"scrollToOffset":z(!0);break;case"inPageLink":B(v(9));break;case"reset":q(N);break;case"init":c(),C("initCallback",N.iframe),C("resizedCallback",N);break;default:c(),C("resizedCallback",N)}}function E(a){var b=!0;return M[a]||(b=!1,i(N.type+" No settings for "+a+". Message was: "+L)),b}function F(){for(var a in M)t("iFrame requested init",u(a),document.getElementById(a),a)}function K(){M[P].firstRun=!1}var L=b.data,N={},P=null;"[iFrameResizerChild]Ready"===L?F():j()?(N=d(),P=O=N.id,!k()&&E(P)&&(g(P,"Received: "+L),x()&&f()&&D())):h(P,"Ignored: "+L)}function l(a,b,c){var d=null,e=null;if(M[a]){if(d=M[a][b],"function"!=typeof d)throw new TypeError(b+" on iFrame["+a+"] is not a function");e=d(c)}return e}function m(a){var b=a.id;g(b,"Removing iFrame: "+b),a.parentNode.removeChild(a),l(b,"closedCallback",b),g(b,"--"),delete M[b]}function n(b){null===J&&(J={x:void 0!==a.pageXOffset?a.pageXOffset:document.documentElement.scrollLeft,y:void 0!==a.pageYOffset?a.pageYOffset:document.documentElement.scrollTop},g(b,"Get page position: "+J.x+","+J.y))}function o(b){null!==J&&(a.scrollTo(J.x,J.y),g(b,"Set page position: "+J.x+","+J.y),p())}function p(){J=null}function q(a){function b(){r(a),t("reset","reset",a.iframe,a.id)}g(a.id,"Size reset requested by "+("init"===a.type?"host page":"iFrame")),n(a.id),s(b,a,"reset")}function r(a){function b(b){a.iframe.style[b]=a[b]+"px",g(a.id,"IFrame ("+e+") "+b+" set to "+a[b]+"px")}function c(b){E||"0"!==a[b]||(E=!0,g(e,"Hidden iFrame detected, creating visibility listener"),y())}function d(a){b(a),c(a)}var e=a.iframe.id;M[e]&&(M[e].sizeHeight&&d("height"),M[e].sizeWidth&&d("width"))}function s(a,b,c){c!==b.type&&K?(g(b.id,"Requesting animation frame"),K(a)):a()}function t(a,b,c,d){function e(){g(d,"["+a+"] Sending msg to iframe["+d+"] ("+b+")"),c.contentWindow.postMessage(H+b,i)}function f(){h(d,"["+a+"] IFrame("+d+") not found"),M[d]&&delete M[d]}d=d||c.id;var i=M[d].targetOrigin;c&&"contentWindow"in c?e():f()}function u(a){return a+":"+M[a].bodyMarginV1+":"+M[a].sizeWidth+":"+M[a].log+":"+M[a].interval+":"+M[a].enablePublicMethods+":"+M[a].autoResize+":"+M[a].bodyMargin+":"+M[a].heightCalculationMethod+":"+M[a].bodyBackground+":"+M[a].bodyPadding+":"+M[a].tolerance+":"+M[a].inPageLinks+":"+M[a].resizeFrom+":"+M[a].widthCalculationMethod}function v(a,c){function d(){function b(b){1/0!==M[v][b]&&0!==M[v][b]&&(a.style[b]=M[v][b]+"px",g(v,"Set "+b+" = "+M[v][b]+"px"))}function c(a){if(M[v]["min"+a]>M[v]["max"+a])throw new Error("Value for min"+a+" can not be greater than max"+a)}c("Height"),c("Width"),b("maxHeight"),b("minHeight"),b("maxWidth"),b("minWidth")}function e(b){return O=b,""===b&&(a.id=b=(c.id||P.id)+C++,D=(c||{}).log,O=b,g(b,"Added missing iframe ID: "+b+" ("+a.src+")")),b}function f(){g(v,"IFrame scrolling "+(M[v].scrolling?"enabled":"disabled")+" for "+v),a.style.overflow=!1===M[v].scrolling?"hidden":"auto",a.scrolling=!1===M[v].scrolling?"no":"yes"}function h(){("number"==typeof M[v].bodyMargin||"0"===M[v].bodyMargin)&&(M[v].bodyMarginV1=M[v].bodyMargin,M[v].bodyMargin=""+M[v].bodyMargin+"px")}function j(){var b=M[v].firstRun,c=M[v].heightCalculationMethod in L;!b&&c&&q({iframe:a,height:0,width:0,type:"init"})}function k(){Function.prototype.bind&&(M[v].iframe.iFrameResizer={close:m.bind(null,M[v].iframe),resize:t.bind(null,"Window resize","resize",M[v].iframe),moveToAnchor:function(a){t("Move to anchor","inPageLink:"+a,M[v].iframe,v)},sendMessage:function(a){a=JSON.stringify(a),t("Send Message","message:"+a,M[v].iframe,v)}})}function l(c){function d(){t("iFrame.onload",c,a),j()}b(a,"load",d),t("init",c,a)}function n(a){if("object"!=typeof a)throw new TypeError("Options is not an object")}function o(a){for(var b in P)P.hasOwnProperty(b)&&(M[v][b]=a.hasOwnProperty(b)?a[b]:P[b])}function p(a){return""===a||"file://"===a?"*":a}function r(b){b=b||{},M[v]={firstRun:!0,iframe:a,remoteHost:a.src.split("/").slice(0,3).join("/")},n(b),o(b),M[v].targetOrigin=!0===M[v].checkOrigin?p(M[v].remoteHost):"*"}function s(){return v in M&&"iFrameResizer"in a}var v=e(a.id);s()?i(v,"Ignored iFrame, already setup."):(r(c),f(),d(),h(),l(u(v)),k())}function w(a,b){null===N&&(N=setTimeout(function(){N=null,a()},b))}function x(a){return null!==a.offsetParent}function y(){function b(){function a(a){function b(b){return"0px"===M[a].iframe.style[b]}x(M[a].iframe)&&(b("height")||b("width"))&&t("Visibility change","resize",M[a].iframe,a)}for(var b in M)a(b)}function c(a){g("window","Mutation observed: "+a[0].target+" "+a[0].type),w(b,16)}function d(){var a=document.querySelector("body"),b={attributes:!0,attributeOldValue:!1,characterData:!0,characterDataOldValue:!1,childList:!0,subtree:!0},d=new e(c);d.observe(a,b)}var e=a.MutationObserver||a.WebKitMutationObserver;e&&d()}function z(){function c(a){function b(){e("Window "+a,"resize")}g("window","Trigger event: "+a),w(b,16)}function d(){function a(){e("Tab Visable","resize")}"hidden"!==document.visibilityState&&(g("document","Trigger event: Visiblity change"),w(a,16))}function e(a,b){function c(a){return"parent"===M[a].resizeFrom&&M[a].autoResize&&!M[a].firstRun}for(var d in M)c(d)&&t(a,b,document.getElementById(d),d)}b(a,"message",k),b(a,"resize",function(){c("resize")}),b(document,"visibilitychange",d),b(document,"-webkit-visibilitychange",d),b(a,"focusin",function(){c("focus")}),b(a,"focus",function(){c("focus")})}function A(){function a(a,c){if(!c.tagName)throw new TypeError("Object is not a valid DOM element");if("IFRAME"!==c.tagName.toUpperCase())throw new TypeError("Expected <IFRAME> tag, found <"+c.tagName+">");v(c,a),b.push(c)}var b;return c(),z(),function(c,d){switch(b=[],typeof d){case"undefined":case"string":Array.prototype.forEach.call(document.querySelectorAll(d||"iframe"),a.bind(void 0,c));break;case"object":a(c,d);break;default:throw new TypeError("Unexpected data type ("+typeof d+")")}return b}}function B(a){a.fn.iFrameResize=function(a){return this.filter("iframe").each(function(b,c){v(c,a)}).end()}}var C=0,D=!1,E=!1,F="message",G=F.length,H="[iFrameSizer]",I=H.length,J=null,K=a.requestAnimationFrame,L={max:1,scroll:1,bodyScroll:1,documentElementScroll:1},M={},N=null,O="Host Page",P={autoResize:!0,bodyBackground:null,bodyMargin:null,bodyMarginV1:8,bodyPadding:null,checkOrigin:!0,inPageLinks:!1,enablePublicMethods:!0,heightCalculationMethod:"bodyOffset",id:"iFrameResizer",interval:32,log:!1,maxHeight:1/0,maxWidth:1/0,minHeight:0,minWidth:0,resizeFrom:"parent",scrolling:!1,sizeHeight:!0,sizeWidth:!1,tolerance:0,widthCalculationMethod:"scroll",closedCallback:function(){},initCallback:function(){},messageCallback:function(){i("MessageCallback function not defined")},resizedCallback:function(){},scrollCallback:function(){return!0}};a.jQuery&&B(jQuery),"function"==typeof define&&define.amd?define([],A):"object"==typeof module&&"object"==typeof module.exports?module.exports=A():a.iFrameResize=a.iFrameResize||A()}(window||{});
//# sourceMappingURL=iframeResizer.map